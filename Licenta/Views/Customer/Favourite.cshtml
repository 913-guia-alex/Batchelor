<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>


    <style>
        .container {
            max-width: 1200px;

        }

        .gym-card {
            position: relative; 
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
            width: 100%;
        }

        .gym-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .gym-address {
            color: #6c757d;
            margin-bottom: 10px;
        }

        .gym-rating {
            color: #007bff;
            font-size: 16px;
            font-weight: bold;
        }

        .star {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            color: #ffd700; 
            font-size: 24px;
        }
            .star:hover {
                transform: scale(1.20); 
                transition: transform 0.3s ease;
            } 

        .menu-items {
            display: inline-block;
            text-align: center;
            margin: auto;
            display: flex;
            padding: 10px 20px;
            margin-top: 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }


        .modal-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        .modal-content {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            width: 100%;
            padding: 20px;
            text-align: center;
        }

        .button-container {
            display: flex;
            justify-content: space-around;
        }

        .button {
            padding: 10px 20px;
            font-size: 16px;
            text-align: center;
            text-decoration: none;
            border-radius: 5px;
            cursor: pointer;
        }
            .button:hover {
                transform: scale(1.05);
                transition: transform 0.3s ease;
            }


        .cancel-button {
            background-color: #ccc;
            color: #535353;
        }
            .cancel-button:hover {
                background-color: #bbb; 
            }

        .delete-button {
            background-color: #e74c3c;
            color: #fff;
        }
            .delete-button:hover {
                background-color: #c0392b;
            }

    </style>
</head>
<body>
    <div class="container body-content">
        <h2 style="text-align: center;">Favorites</h2>

        <div class="redirect-container" style="text-align: center; margin-bottom: 20px;">
            <i class="fas fa-arrow-left" id="redirectArrow" style="cursor: pointer; font-size: 24px;"></i>
            <span id="goBackText" style="cursor: pointer; font-size: 24px; margin-left: 10px;">Go Back</span>
        </div>

        @if (ViewBag.Favourites != null && ViewBag.Favourites.Count > 0)
        {
            foreach (var favourite in ViewBag.Favourites)
            {
                <div class="gym-card">
                    <div class="gym-name">@(!string.IsNullOrEmpty(favourite.Gym?.name) ? favourite.Gym.name : "Unknown")</div>
                    <div class="gym-address">@(!string.IsNullOrEmpty(favourite.Gym?.adress) ? favourite.Gym.adress : "Address not available")</div>
                    <div class="gym-rating">Rating: @(favourite.Gym?.rating ?? 0)</div>
                    <i class="fas fa-star star" onclick="showDeleteConfirmation(@favourite.idf)"></i>
                </div>
            }
        }
        else
        {
            <p style="text-align: center; font-size: 20px; color: #555; line-height: 1.5;">Hey there! Looks like your favorite gyms list is empty right now. No worries, let's fix that! Click the button below to explore and add some amazing gyms to your favorites.</p>
        }
        <button class="menu-items" onclick="redirectToAllGyms()">
            <i class="fas fa-store"></i> All Gyms
        </button>
    </div>



    <div id="modal" class="modal-container">
        <div class="modal-content">
            <h2>Delete Confirmation</h2>
            <p class="confirmation-message">
                Are you sure you want to delete this item?
            </p>
            <div class="button-container">
                <button id="cancelBtn" class="button cancel-button">
                    Cancel
                </button>
                <button id="deleteBtn" class="button delete-button">
                    Delete
                </button>
            </div>
        </div>
    </div>

    <script>

        function showDeleteConfirmation(favouriteId) {
            const modal = document.getElementById('modal');
            modal.style.display = 'flex';
            const deleteBtn = document.getElementById('deleteBtn');
            deleteBtn.onclick = function () {
                removeGymFromFavorites(favouriteId);
            }
            const cancelBtn = document.getElementById('cancelBtn');
            cancelBtn.onclick = function () {
                hideModal();
            }
        }

        function getCustomerId() {
            var url = window.location.href;
            var customerIdIndex = url.lastIndexOf("/") + 1;
            var customerId = url.substr(customerIdIndex);

            if (!isNaN(customerId) && parseInt(customerId) > 0) {
                return parseInt(customerId);
            } else {
                alert("Please log in to access this feature.");
                window.location.href = "/Account/Login";
            }
        }

        // Add event listener to the arrow icon
        $(document).ready(function () {
            $("#redirectArrow").click(function () {
                var customerId = getCustomerId();
                window.location.href = "/Customer/Main/" + customerId;
            });

            console.log("jQuery loaded successfully!"); // Check if jQuery is loaded
        });

        function removeGymFromFavorites(favouriteId) {
            $.ajax({
                type: "POST",
                url: "/Customer/RemoveFromFavorites",
                data: { favouriteId: favouriteId },
                success: function (response) {
                    console.log("Gym removed from favorites successfully.");
                    location.reload();
                },
                error: function (xhr, status, error) {
                    console.error("Error removing gym from favorites:", error);
                }
            });
        }

        function hideModal() {
            const modal = document.getElementById('modal');
            modal.style.display = 'none';
        }

        function redirectToAllGyms() {
            window.location.href = "/Gym/AllGymCustomer/@((int)ViewBag.Customer.idc)";
        }
    </script>


</body>
</html>
